services:

  dev:
    image: claudebase:latest
    build:
      context: .
      dockerfile: Dockerfile
    container_name: ${container_name:-$(basename "$(dirname "$(dirname "$PWD")")")}
    volumes:
      - ~/.aws:/home/ubuntu/.aws
      - ~/.gitconfig:/home/ubuntu/.gitconfig
      - ~/.git-credentials:/home/ubuntu/.git-credentials
      - ~/google_credential.json:/etc/google_credentials.json
      - /var/run/docker.sock:/var/run/docker.sock
      - ~/.claude.json:/home/ubuntu/.claude.json
      - ~/.clasprc.json:/home/ubuntu/.clasprc.json
    env_file: .env
    user: "${U_ID}:${G_ID}"
    group_add: ["${DOCKER_GID}"]
    command: ["${GIT_USER}", "${GIT_REPO}", "tail", "-f", "/dev/null"]
    networks:
      - net

networks:
  net:
